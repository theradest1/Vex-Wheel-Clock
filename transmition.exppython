{"mode":"Text","textContent":"#region VEXcode Generated Robot Configuration\nfrom vex import *\nimport urandom\n\n# Brain should be defined by default\nbrain = Brain()\n\n# Robot configuration code\nbrain_inertial = Inertial()\nShifter_1 = Motor(Ports.PORT1, False)\nShifter_2 = Motor(Ports.PORT2, False)\nDrive = Motor(Ports.PORT3, False)\nSteering = Motor(Ports.PORT4, False)\ncontroller = Controller()\nDrive_Extra = Motor(Ports.PORT5, True)\n\n\n# Wait for sensor(s) to fully initialize\nwait(100, MSEC)\n\n#endregion VEXcode Generated Robot Configuration\n# ------------------------------------------\n# \n# \tProject:      VEXcode Project\n#\tAuthor:       VEX\n#\tCreated:\n#\tDescription:  VEXcode EXP Python Project\n# \n# ------------------------------------------\n\n# Library imports\nfrom vex import *\n\nDrive.set_velocity(100, PERCENT)\nDrive.set_max_torque(100, PERCENT)\nDrive_Extra.set_velocity(100, PERCENT)\nDrive_Extra.set_max_torque(100, PERCENT)\nSteering.set_velocity(50, PERCENT)\nSteering.set_max_torque(100, PERCENT)\n\nShifter_1.set_stopping(HOLD)\nShifter_2.set_stopping(HOLD)\nSteering.set_stopping(HOLD)\nDrive.set_stopping(COAST)\nDrive_Extra.set_stopping(COAST)\n\nShifter_1.set_position(0, DEGREES)\nShifter_2.set_position(0, DEGREES)\nSteering.set_position(0, DEGREES)\nDrive.set_position(0, DEGREES)\nDrive_Extra.set_position(0, DEGREES)\n\ncurrentGear = 0 #0 is neutral\nmaxGear = 3\n\nmaxSteeringAngle = 170 # degrees\nsteeringAxisRatio = maxSteeringAngle/90\n\n#all time is in ms\nautomaticShifting = False\nshifterDistance = 25 #degrees\nshifterJitter = 6 #to combat the large slits\n\nlastGearChangeTime = 0\nminGearChangeTime = 400 #only for automatic shifting[]\nvelPercentForGearUp = 98 #in percent\nvelPercentForGearDown = 0 #in percent\n\nbrain.timer.clear()\n\nclutchConnected = True\n\ndef centerGear(shifter):\n    shifter.set_velocity(100, PERCENT)\n    shifter.set_max_torque(100, PERCENT)\n    shifter.spin_to_position(-shifterJitter, DEGREES, True)\n    shifter.spin_to_position(shifterJitter, DEGREES, True)\n    shifter.spin_to_position(0, DEGREES, True)\n\n\ndef shiftTo(newGear):\n    global currentGear, lastGearChangeTime, clutchConnected\n\n    lastGearChangeTime = brain.timer.time(MSEC)\n\n    if newGear >= 0 and newGear <= maxGear:\n        currentGear = newGear\n\n    #artificial clutch\n    Drive.set_max_torque(25, PERCENT)\n    Drive_Extra.set_max_torque(25, PERCENT)\n    clutchConnected = True\n    \n\n    #actually set gear\n    if currentGear == -1: #reverse\n        centerGear(Shifter_1)\n\n        Shifter_2.set_velocity(35, PERCENT)\n        Shifter_2.set_max_torque(80, PERCENT)\n        Shifter_2.spin_to_position(-shifterDistance, DEGREES, False)\n    elif currentGear == 0: #neutral\n        centerGear(Shifter_1)\n        centerGear(Shifter_2)\n    elif currentGear == 1:\n        centerGear(Shifter_2)\n        \n        Shifter_1.set_velocity(35, PERCENT)\n        Shifter_1.set_max_torque(80, PERCENT)\n        Shifter_1.spin_to_position(shifterDistance, DEGREES, False)\n    elif currentGear == 2:\n        centerGear(Shifter_2)\n\n        Shifter_1.set_velocity(35, PERCENT)\n        Shifter_1.set_max_torque(80, PERCENT)\n        Shifter_1.spin_to_position(-shifterDistance, DEGREES, False)\n    elif currentGear == 3:\n        centerGear(Shifter_1)\n\n        Shifter_2.set_velocity(35, PERCENT)\n        Shifter_2.set_max_torque(80, PERCENT)\n        Shifter_2.spin_to_position(shifterDistance, DEGREES, False)\n    \n    Drive.set_max_torque(100, PERCENT)\n    Drive_Extra.set_max_torque(100, PERCENT)\n    clutchConnected = False\n\ndef shiftUp():\n    shiftTo(currentGear + 1)\n\ndef shiftDown():\n    shiftTo(currentGear - 1)\n\ndef clamp(valueDefault, minValue, maxValue):\n    return max(minValue, min(maxValue, valueDefault))\n\ndef main():\n    global clutchConnected\n    while True:\n        #drive\n        if controller.buttonR1.pressing():\n            Drive.spin(FORWARD)\n            Drive_Extra.spin(FORWARD)\n        elif controller.buttonR2.pressing():\n            Drive.spin(REVERSE)\n            Drive_Extra.spin(REVERSE)\n        else:\n            Drive.stop()\n            Drive_Extra.stop()\n            #go to nutral if not accelerating\n            if automaticShifting:\n                shiftTo(0)\n\n        #steering\n        targetAngle = -clamp(controller.axis1.position() * steeringAxisRatio, -maxSteeringAngle, maxSteeringAngle)\n        Steering.spin_to_position(targetAngle, DEGREES, False)\n        \n\n        #debug\n        brain.screen.set_cursor(1,1)\n        brain.screen.clear_row(1)\n        brain.screen.print(\"Vel (RPM): \" + str(Drive.velocity(RPM)))\n\n        brain.screen.set_cursor(2,1)\n        brain.screen.clear_row(2)\n        brain.screen.print(\"Vel (PRCNT): \" + str(Drive.velocity(PERCENT)))\n\n        brain.screen.set_cursor(3,1)\n        brain.screen.clear_row(3)\n        brain.screen.print(\"Gear: \" + str(currentGear))\n\n        brain.screen.set_cursor(4,1)\n        brain.screen.clear_row(4)\n        brain.screen.print(\"Shift time: \" + str(brain.timer.time(SECONDS) - lastGearChangeTime/1000))\n\n        brain.screen.set_cursor(5,1)\n        brain.screen.clear_row(5)\n        brain.screen.print(\"Steering: \" + str(clamp(controller.axis1.position() * steeringAxisRatio, -maxSteeringAngle, maxSteeringAngle)))\n\n\ncontroller.buttonA.pressed(shiftUp)\ncontroller.buttonB.pressed(shiftDown)\nmain()","textLanguage":"python","rconfig":[{"port":[1],"name":"Shifter_1","customName":true,"deviceType":"Motor","deviceClass":"motor","setting":{"reversed":"false","fwd":"forward","rev":"reverse"},"triportSourcePort":22},{"port":[2],"name":"Shifter_2","customName":true,"deviceType":"Motor","deviceClass":"motor","setting":{"reversed":"false","fwd":"forward","rev":"reverse"},"triportSourcePort":22},{"port":[3],"name":"Drive","customName":true,"deviceType":"Motor","deviceClass":"motor","setting":{"reversed":"false","fwd":"forward","rev":"reverse"},"triportSourcePort":22},{"port":[4],"name":"Steering","customName":true,"deviceType":"Motor","deviceClass":"motor","setting":{"reversed":"false","fwd":"forward","rev":"reverse"},"triportSourcePort":22},{"port":[],"name":"controller","customName":false,"deviceType":"Controller","deviceClass":"controller","setting":{"left":"","leftDir":"false","right":"","rightDir":"false","e":"","eDir":"false","f":"","fDir":"false","l3r3":"","l3r3Dir":"false","drive":"none"},"triportSourcePort":22},{"port":[5],"name":"Drive_Extra","customName":true,"deviceType":"Motor","deviceClass":"motor","setting":{"reversed":"true","fwd":"forward","rev":"reverse"},"triportSourcePort":22}],"slot":0,"platform":"EXP","sdkVersion":"20240219.10.00.00","appVersion":"3.1.1","minVersion":"3.1.0","fileFormat":"1.2.0","icon":"","targetBrainGen":"First","v5SoundsEnabled":false,"target":"Physical"}